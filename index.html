<!DOCTYPE html>
<html>
<head>
<title>Navglid â€“ Smart Navigation Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{margin:0;font-family:Arial}
#map{height:100vh}

/* Brand */
#brand{
position:absolute;top:10px;left:50%;
transform:translateX(-50%);
background:#111;color:#fff;
padding:8px 18px;border-radius:20px;
font-weight:bold;z-index:9999;
}

/* Info */
#info{
position:absolute;bottom:90px;left:50%;
transform:translateX(-50%);
background:#fff;padding:12px;
border-radius:14px;z-index:900;
}

/* Widgets */
.widget{
position:absolute;right:20px;
background:#fff;padding:6px 12px;
border-radius:10px;z-index:800;
}
#speed{top:80px}
#distance{top:125px}
#markerDistance{top:170px}
#addA{top:215px}
#addB{top:260px}
#clearMarkers{top:305px}

/* Bottom toolbar */
#toolbarWrap{
position:fixed;bottom:0;left:0;width:100%;
background:#fff;z-index:5000;
border-radius:18px 18px 0 0;
box-shadow:0 -4px 12px rgba(0,0,0,.3);
}
#toolbarHeader{
padding:10px;text-align:center;
font-weight:bold;border-bottom:1px solid #ddd;
cursor:pointer;
}
#toolbarContent{
max-height:40vh;overflow:auto;
padding:10px;display:none;
}
.show #toolbarContent{display:block}
</style>
</head>

<body>

<div id="map"></div>
<div id="brand">NAVGLID</div>

<div id="info">ðŸ“¡ Detecting GPS...</div>
<div id="speed" class="widget">Speed: 0 km/h</div>
<div id="distance" class="widget">Travel: 0 m</div>
<div id="markerDistance" class="widget">A â†” B: 0 m</div>

<button id="addA" class="widget">Set Point A</button>
<button id="addB" class="widget">Set Point B</button>
<button id="clearMarkers" class="widget">Clear</button>

<!-- Bottom toolbar -->
<div id="toolbarWrap">
<div id="toolbarHeader" onclick="toggleToolbar()">â¬† Map Styles</div>
<div id="toolbarContent"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
var map=L.map('map',{maxZoom:22}).setView([20,0],2);

// MAP LAYERS
var street=L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
var satellite=L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');
var terrain=L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png');

street.addTo(map);

const layers={Street:street,Satellite:satellite,Terrain:terrain};

// TOOLBAR
const cont=document.getElementById("toolbarContent");
for(let k in layers){
let b=document.createElement("button");
b.innerHTML=k;
b.style.width="100%";
b.style.padding="10px";
b.onclick=()=>{
for(let i in layers)map.removeLayer(layers[i]);
layers[k].addTo(map);
};
cont.appendChild(b);
}
function toggleToolbar(){
toolbarWrap.classList.toggle("show");
}

/* GPS */
let userMarker=null;
let lastPos=null;
let totalDist=0;

function gpsSuccess(p){
let lat=p.coords.latitude;
let lng=p.coords.longitude;
let sp=p.coords.speed||0;

info.innerHTML="ðŸ“ GPS Locked";
speed.innerHTML="Speed: "+(sp*3.6).toFixed(1)+" km/h";

if(!userMarker){
userMarker=L.marker([lat,lng]).addTo(map);
map.setView([lat,lng],18);
}else{
userMarker.setLatLng([lat,lng]);
}

if(lastPos){
totalDist+=map.distance(lastPos,[lat,lng]);
distance.innerHTML="Travel: "+formatDist(totalDist);
}
lastPos=[lat,lng];
}

function gpsError(err){
if(err.code===1) info.innerHTML="âŒ Permission denied";
else if(err.code===2) info.innerHTML="ðŸ“¡ GPS unavailable";
else info.innerHTML="âš  GPS timeout";
}

navigator.geolocation.watchPosition(
gpsSuccess,
gpsError,
{enableHighAccuracy:true,timeout:10000}
);

/* DISTANCE FORMAT */
function formatDist(m){
let km=(m/1000).toFixed(2);
let mile=(m/1609.34).toFixed(2);
return `${m.toFixed(1)} m | ${km} km | ${mile} mi`;
}

/* MARKER DISTANCE */
let A=null,B=null,line=null;

function updateAB(){
if(A && B){
let d=map.distance(A.getLatLng(),B.getLatLng());
markerDistance.innerHTML=
"A â†” B: "+formatDist(d);

if(line) map.removeLayer(line);
line=L.polyline([A.getLatLng(),B.getLatLng()],
{color:"red"}).addTo(map);
}
}

addA.onclick=()=>{
if(!userMarker) return alert("GPS not ready!");
if(A) map.removeLayer(A);
A=L.marker(userMarker.getLatLng(),{draggable:true}).addTo(map);
A.on("drag",updateAB);
updateAB();
};

addB.onclick=()=>{
if(!userMarker) return alert("GPS not ready!");
if(B) map.removeLayer(B);
B=L.marker(userMarker.getLatLng(),{draggable:true}).addTo(map);
B.on("drag",updateAB);
updateAB();
};

clearMarkers.onclick=()=>{
if(A) map.removeLayer(A);
if(B) map.removeLayer(B);
if(line) map.removeLayer(line);
A=B=line=null;
markerDistance.innerHTML="A â†” B: 0 m";
};
</script>

</body>
</html>
